<Window
    x:Class="ShoukatSons.UI.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="ShoukatSons"
    Height="600"
    Width="900"
    MinHeight="400"
    MinWidth="700"
    WindowStartupLocation="CenterScreen"
    SnapsToDevicePixels="True"
    UseLayoutRounding="True">

  <Window.Resources>
    <BooleanToVisibilityConverter x:Key="BoolToVis" />
  </Window.Resources>

  <Window.InputBindings>
    <!-- Quick reload -->
    <KeyBinding Key="F5" Command="{Binding LoadDataCommand}" />
  </Window.InputBindings>

  <Grid Margin="10">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Toolbar -->
    <DockPanel Grid.Row="0" LastChildFill="False" Margin="0,0,0,10">
      <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" VerticalAlignment="Center">
        <Button
          Content="Load Data (F5)"
          Command="{Binding LoadDataCommand}"
          Width="120"
          Height="30"/>
          <!-- Inside the right-side StackPanel in your toolbar -->
<Button
  Content="Barcode Print"
  Width="120"
  Height="30"
  Margin="8,0,0,0"
  Click="OpenBarcodePrint_Click"/>
        <ProgressBar
          Width="140"
          Height="6"
          IsIndeterminate="True"
          Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"
          VerticalAlignment="Center"
          Margin="8,0,0,0"/>
      </StackPanel>
    </DockPanel>

    <!-- Section title -->
    <TextBlock
      Grid.Row="1"
      Text="Product List"
      FontSize="16"
      FontWeight="Bold"
      Margin="0,0,0,5"/>

    <!-- Search row -->
    <Grid Grid.Row="2" Margin="0,0,0,10">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="10"/>
        <ColumnDefinition Width="250"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <TextBlock
        Grid.Column="0"
        VerticalAlignment="Center"
        Text="Search:"/>

      <TextBox
        Grid.Column="2"
        Height="25"
        Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
        ToolTip="Type to filter products by name, ID, or price"/>
    </Grid>

    <!-- Data region with empty-state + busy overlay -->
    <Grid Grid.Row="3">
      <!-- DataGrid -->
      <DataGrid
        x:Name="ProductsGrid"
        ItemsSource="{Binding ProductsView}"
        AutoGenerateColumns="False"
        IsReadOnly="True"
        CanUserAddRows="False"
        SelectionMode="Single"
        RowHeaderWidth="0"
        AlternatingRowBackground="#FFF6F6F6"
        AlternationCount="2"
        EnableRowVirtualization="True"
        EnableColumnVirtualization="True"
        VirtualizingPanel.IsVirtualizing="True"
        VirtualizingPanel.VirtualizationMode="Recycling">
        <DataGrid.Columns>
          <DataGridTextColumn
            Header="ID"
            Binding="{Binding Id}"
            Width="Auto"/>
          <DataGridTextColumn
            Header="Name"
            Binding="{Binding Name}"
            Width="*"/>
          <DataGridTextColumn
            Header="Price"
            Binding="{Binding Price, StringFormat={}{0:C}}"
            Width="120">
            <DataGridTextColumn.ElementStyle>
              <Style TargetType="TextBlock">
                <Setter Property="TextAlignment" Value="Right"/>
              </Style>
            </DataGridTextColumn.ElementStyle>
          </DataGridTextColumn>
        </DataGrid.Columns>
      </DataGrid>

      <!-- Empty-state placeholder (shown when there are no items) -->
      <Border
        Background="{x:Null}"
        Padding="24"
        Visibility="Collapsed">
        <Border.Style>
          <Style TargetType="Border">
            <Setter Property="Visibility" Value="Collapsed"/>
            <Style.Triggers>
              <DataTrigger Binding="{Binding ElementName=ProductsGrid, Path=HasItems}" Value="False">
                <Setter Property="Visibility" Value="Visible"/>
              </DataTrigger>
            </Style.Triggers>
          </Style>
        </Border.Style>
        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
          <TextBlock Text="No products to display yet." FontSize="14" FontWeight="SemiBold" Foreground="#555"/>
          <TextBlock Text="Click “Load Data” or press F5 to fetch items." Foreground="#777" Margin="0,8,0,0"/>
        </StackPanel>
      </Border>

      <!-- Busy overlay -->
      <Grid
        Background="#80FFFFFF"
        Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"
        Panel.ZIndex="100">
        <Border
          CornerRadius="6"
          Padding="16"
          Background="White"
          BorderBrush="#DDD"
          BorderThickness="1"
          HorizontalAlignment="Center"
          VerticalAlignment="Center">
          <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
            <ProgressBar Width="220" Height="8" IsIndeterminate="True"/>
            <TextBlock Text="Loading products..." Foreground="#555" Margin="0,10,0,0"/>
          </StackPanel>
        </Border>
      </Grid>
    </Grid>

    <!-- Status bar -->
    <StatusBar Grid.Row="4" Margin="0,10,0,0">
      <StatusBarItem>
        <TextBlock Text="{Binding Products.Count, StringFormat=Items: {0}}"/>
      </StatusBarItem>
      <StatusBarItem HorizontalAlignment="Right">
        <TextBlock Text="{Binding IsBusy, StringFormat=Busy: {0}}"/>
      </StatusBarItem>
    </StatusBar>
  </Grid>
</Window>